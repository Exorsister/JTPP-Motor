(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6005],{4184:function(e,t){var r;!function(){"use strict";var a={}.hasOwnProperty;function n(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)){if(r.length){var s=n.apply(null,r);s&&e.push(s)}}else if("object"===o){if(r.toString!==Object.prototype.toString&&!r.toString.toString().includes("[native code]")){e.push(r.toString());continue}for(var i in r)a.call(r,i)&&r[i]&&e.push(i)}}}return e.join(" ")}e.exports?(n.default=n,e.exports=n):void 0!==(r=(function(){return n}).apply(t,[]))&&(e.exports=r)}()},1706:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backend/Car/Model/[Brands_ID]",function(){return r(1344)}])},1344:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return p}});var a=r(5893),n=r(645),o=r.n(n),s=r(1163),i=r(7294),d=r(2198),c=r(6455),l=r.n(c),f=r(7630),b=r.n(f),m=r(343),u=r(4269);r(1664),r(6245);let g=b()(l()),x=(0,m.ZP)(),h=(0,i.forwardRef)((e,t)=>{let{model:r,productOptions:n,onSelectedChange:o}=e,[s,d]=(0,i.useState)(r.recommendedProducts||[]);(0,i.useImperativeHandle)(t,()=>({resetState:()=>{d([]),o&&o([])}}));let c=(e,t)=>{let r=[...s];r[e]=t?t.value:null,d(r),o&&o(r)},l=e=>{let t=s.filter((t,r)=>r!==e);d(t),o&&o(t)};return(0,a.jsxs)("div",{children:[s.map((e,t)=>(0,a.jsxs)("div",{className:"form-group mb-3 d-flex align-items-center",children:[(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)("label",{children:"สินค้า ".concat(t+1)}),(0,a.jsx)(u.ZP,{closeMenuOnSelect:!0,components:x,options:n,value:e?n.find(t=>t.value===e):null,onChange:e=>c(t,e),placeholder:"เลือกสินค้าชิ้นที่ ".concat(t+1)})]}),(0,a.jsx)("button",{type:"button",className:"btn btn-danger ms-2",onClick:()=>l(t),children:"ลบ"})]},t)),(0,a.jsx)("button",{type:"button",className:"btn btn-success",onClick:()=>{d(e=>[...e,null])},children:"เพิ่มสินค้า"})]})});function p(){let e=(0,s.useRouter)(),{Brands_ID:t}=e.query,[r,n]=(0,i.useState)(""),[c,f]=(0,i.useState)([]),[b,m]=(0,i.useState)([]),u=(0,i.useRef)(null);(0,i.useEffect)(()=>{(async()=>{if(t)try{let e=await fetch("https://server.jtppmotor.com/api/car/get_model/".concat(t));if(!e.ok){l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรุ่นได้","error");return}let r=await e.json();f(r)}catch(e){console.error("เกิดข้อผิดพลาดในการดึงข้อมูลรุ่น:",e),l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรุ่นได้","error")}})()},[t]),(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("https://server.jtppmotor.com/api/all_products");if(e.ok){let t=await e.json();m(t)}else l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลสินค้าได้","error")}catch(e){console.error("Error fetching all products:",e),l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลสินค้าได้","error")}})()},[]);let x=async()=>{if(t)try{let e=await fetch("https://server.jtppmotor.com/api/car/get_model/".concat(t));if(!e.ok){l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรุ่นได้","error");return}let r=await e.json();f(r)}catch(e){console.error("เกิดข้อผิดพลาดในการดึงข้อมูลรุ่น:",e),l().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรุ่นได้","error")}},p=async e=>{if(!t){l().fire("ผิดพลาด","ไม่พบข้อมูลแบรนด์","error");return}try{let r=await fetch("https://server.jtppmotor.com/api/car/add_model",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Brands_ID:t,Models_Name:e})});if(r.ok)await x(),l().fire("สำเร็จ","เพิ่มรุ่นสำเร็จแล้ว","success");else{let e=await r.json();console.error("API Error:",e),l().fire("ผิดพลาด","เกิดข้อผิดพลาดบางอย่าง: "+(e.error||"ไม่มีรายละเอียด"),"error")}}catch(e){console.error("Caught Error:",e),l().fire("ผิดพลาด","การเพิ่มรุ่นล้มเหลว","error")}},j=async(e,t)=>{try{let r=await fetch("https://server.jtppmotor.com/api/car/edit_model/".concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({Models_Name:t})});if(r.ok)await x(),l().fire("สำเร็จ","อัปเดตรุ่นสำเร็จแล้ว","success");else{let e=await r.json();console.error("API Error:",e),l().fire("ผิดพลาด","เกิดข้อผิดพลาดบางอย่าง: "+(e.error||"ไม่มีรายละเอียด"),"error")}}catch(e){console.error("Caught Error:",e),l().fire("ผิดพลาด","การอัปเดตรุ่นล้มเหลว","error")}},k=async e=>{try{let t=await fetch("https://server.jtppmotor.com/api/car/delete_model/".concat(e),{method:"DELETE"});if(t.ok)await x(),l().fire("สำเร็จ","ลบรุ่นสำเร็จแล้ว","success");else{let e=await t.json();console.error("API Error:",e),l().fire("ผิดพลาด","เกิดข้อผิดพลาดบางอย่าง: "+(e.error||"ไม่มีรายละเอียด"),"error")}}catch(e){console.error("Caught Error:",e),l().fire("ผิดพลาด","การลบรุ่นล้มเหลว","error")}},w=e=>{g.fire({title:"แก้ไขรุ่น",html:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("input",{type:"text",className:"form-control",placeholder:"ชื่อรุ่น",id:"modelName",defaultValue:e.Models_Name})}),showCancelButton:!0,confirmButtonText:"อัปเดตรุ่น",cancelButtonText:"ยกเลิก",preConfirm:()=>{let t=g.getPopup().querySelector("#modelName").value;return t?{Models_ID:e.Models_ID,modelName:t}:(g.showValidationMessage("กรุณากรอกชื่อรุ่น"),!1)}}).then(e=>{e.isConfirmed&&j(e.value.Models_ID,e.value.modelName)})},y=e=>{g.fire({title:"ยืนยันการลบ",text:"คุณแน่ใจว่าต้องการลบรุ่น ".concat(e.Models_Name,"?"),icon:"warning",showCancelButton:!0,confirmButtonText:"ลบ",cancelButtonText:"ยกเลิก"}).then(t=>{t.isConfirmed&&k(e.Models_ID)})},N=c.filter(e=>e.Models_Name&&e.Models_Name.toLowerCase().includes(r.toLowerCase())),_=async e=>{let t=[];try{let r=await fetch("https://server.jtppmotor.com/api/car/get_model_products/".concat(e.Models_ID));r.ok&&(t=(await r.json()).map(e=>e.Product_ID))}catch(e){console.error("Error fetching recommended products:",e)}let r={...e,recommendedProducts:t},n=b.map(e=>({value:e.Product_ID,label:"".concat(e.Product_Name," (").concat(e.Product_Brand,")")})),o=[];g.fire({title:"จัดการสินค้า: ".concat(e.Models_Name),html:(0,a.jsx)(h,{ref:u,model:r,productOptions:n,onSelectedChange:e=>{o=e}}),showCancelButton:!0,showDenyButton:!0,confirmButtonText:"บันทึก",denyButtonText:"รีเซ็ต",cancelButtonText:"ยกเลิก",preConfirm:()=>o,preDeny:()=>(u.current&&u.current.resetState(),!1)}).then(t=>{t.isConfirmed&&v({Models_ID:e.Models_ID,recommendedProducts:t.value})})},v=async e=>{let{Models_ID:t,recommendedProducts:r}=e;try{let e=await fetch("https://server.jtppmotor.com/api/car/update_model_products/".concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({recommendedProducts:r})});if(e.ok)l().fire("สำเร็จ","บันทึกสินค้าสำหรับรุ่นสำเร็จแล้ว","success").then(()=>{x()});else{let t=await e.json();l().fire("ผิดพลาด","ไม่สามารถบันทึกสินค้าได้: ".concat(t.error||"ไม่มีรายละเอียด"),"error")}}catch(e){console.error("Error updating products:",e),l().fire("ผิดพลาด","เกิดข้อผิดพลาดในการบันทึกสินค้า","error")}};return(0,a.jsxs)("div",{className:"jsx-7bf74096ad2f8413 d-flex",children:[(0,a.jsx)(d.default,{}),(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 flex-grow-1 model-container",children:(0,a.jsxs)("div",{className:"jsx-7bf74096ad2f8413 container py-4",children:[(0,a.jsxs)("div",{style:{backgroundColor:"#fff",borderBottom:"1px solid #dee2e6",padding:"10px 0"},className:"jsx-7bf74096ad2f8413 header d-flex justify-content-between align-items-center mb-4",children:[(0,a.jsx)("h2",{className:"jsx-7bf74096ad2f8413 page-title",children:"ข้อมูลรุ่นรถ"}),(0,a.jsxs)("button",{type:"button",onClick:()=>e.back(),className:"jsx-7bf74096ad2f8413 btn btn-outline-secondary btn-back",children:[(0,a.jsx)("i",{className:"jsx-7bf74096ad2f8413 bi bi-arrow-left"})," ย้อนกลับ"]})]}),(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 card mb-4 shadow-sm",children:(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 card-body",children:(0,a.jsxs)("div",{className:"jsx-7bf74096ad2f8413 d-flex justify-content-between align-items-center",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>{g.fire({title:"เพิ่มรุ่น",html:(0,a.jsx)("input",{type:"text",className:"form-control",placeholder:"ชื่อรุ่น",id:"modelName"}),showCancelButton:!0,confirmButtonText:"เพิ่มรุ่น",cancelButtonText:"ยกเลิก",preConfirm:()=>{let e=g.getPopup().querySelector("#modelName").value;return e?{modelName:e}:(g.showValidationMessage("กรุณากรอกชื่อรุ่น"),!1)}}).then(e=>{e.isConfirmed&&p(e.value.modelName)})},className:"jsx-7bf74096ad2f8413 btn btn-success",children:[(0,a.jsx)("i",{className:"jsx-7bf74096ad2f8413 bi bi-plus-circle me-2"}),"เพิ่มรุ่น"]}),(0,a.jsx)("input",{type:"text",placeholder:"ค้นหา...",value:r,onChange:e=>{n(e.target.value)},className:"jsx-7bf74096ad2f8413 form-control w-auto search-input"})]})})}),(0,a.jsxs)("div",{className:"jsx-7bf74096ad2f8413 card shadow-sm",children:[(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 card-header income-gradient text-white",children:(0,a.jsx)("h5",{className:"jsx-7bf74096ad2f8413 mb-0",children:"รายการรุ่นรถ"})}),(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 card-body",children:(0,a.jsx)("div",{className:"jsx-7bf74096ad2f8413 table-responsive",children:(0,a.jsxs)("table",{className:"jsx-7bf74096ad2f8413 table table-striped table-hover align-middle",children:[(0,a.jsx)("thead",{className:"jsx-7bf74096ad2f8413 table-light",children:(0,a.jsxs)("tr",{className:"jsx-7bf74096ad2f8413",children:[(0,a.jsx)("th",{className:"jsx-7bf74096ad2f8413",children:"ลำดับ"}),(0,a.jsx)("th",{className:"jsx-7bf74096ad2f8413",children:"ชื่อรุ่น"}),(0,a.jsx)("th",{className:"jsx-7bf74096ad2f8413",children:"จัดการ"})]})}),(0,a.jsx)("tbody",{className:"jsx-7bf74096ad2f8413",children:N.length>0?N.map((e,t)=>(0,a.jsxs)("tr",{className:"jsx-7bf74096ad2f8413",children:[(0,a.jsx)("td",{className:"jsx-7bf74096ad2f8413",children:t+1}),(0,a.jsx)("td",{className:"jsx-7bf74096ad2f8413",children:e.Models_Name}),(0,a.jsxs)("td",{className:"jsx-7bf74096ad2f8413",children:[(0,a.jsxs)("button",{onClick:()=>_(e),className:"jsx-7bf74096ad2f8413 btn btn-primary me-2",children:[(0,a.jsx)("i",{className:"jsx-7bf74096ad2f8413 bi bi-box me-1"}),"สินค้า"]}),(0,a.jsxs)("button",{onClick:()=>w(e),className:"jsx-7bf74096ad2f8413 btn btn-warning me-2",children:[(0,a.jsx)("i",{className:"jsx-7bf74096ad2f8413 bi bi-pencil me-1"}),"แก้ไขชื่อ"]}),(0,a.jsxs)("button",{onClick:()=>y(e),className:"jsx-7bf74096ad2f8413 btn btn-danger",children:[(0,a.jsx)("i",{className:"jsx-7bf74096ad2f8413 bi bi-trash me-1"}),"ลบ"]})]})]},e.Models_ID)):(0,a.jsx)("tr",{className:"jsx-7bf74096ad2f8413",children:(0,a.jsx)("td",{colSpan:"3",className:"jsx-7bf74096ad2f8413 text-center",children:"ไม่พบข้อมูลรุ่น"})})})]})})})]})]})}),(0,a.jsx)(o(),{id:"7bf74096ad2f8413",children:".model-container.jsx-7bf74096ad2f8413{background-color:#f0f2f5;min-height:100vh;padding:20px}.page-title.jsx-7bf74096ad2f8413{margin:0;font-size:1.5rem;font-weight:700;background:-webkit-linear-gradient(45deg,#2c3e50,#3498db);background:-moz-linear-gradient(45deg,#2c3e50,#3498db);background:-o-linear-gradient(45deg,#2c3e50,#3498db);background:linear-gradient(45deg,#2c3e50,#3498db);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.search-input.jsx-7bf74096ad2f8413{max-width:300px;-webkit-border-radius:20px;-moz-border-radius:20px;border-radius:20px;padding:10px 20px;border:2px solid#e0e0e0;-webkit-transition:all.3s;-moz-transition:all.3s;-o-transition:all.3s;transition:all.3s}.search-input.jsx-7bf74096ad2f8413:focus{border-color:#2ecc71;-webkit-box-shadow:0 0 0 .2rem rgba(46,204,113,.25);-moz-box-shadow:0 0 0 .2rem rgba(46,204,113,.25);box-shadow:0 0 0 .2rem rgba(46,204,113,.25)}.btn.jsx-7bf74096ad2f8413{-webkit-transition:all.3s;-moz-transition:all.3s;-o-transition:all.3s;transition:all.3s}.btn.jsx-7bf74096ad2f8413:hover{-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}.btn-success.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(45deg,#2ecc71,#27ae60);background:-moz-linear-gradient(45deg,#2ecc71,#27ae60);background:-o-linear-gradient(45deg,#2ecc71,#27ae60);background:linear-gradient(45deg,#2ecc71,#27ae60);border:none;padding:10px 20px}.btn-primary.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(45deg,#3498db,#2980b9);background:-moz-linear-gradient(45deg,#3498db,#2980b9);background:-o-linear-gradient(45deg,#3498db,#2980b9);background:linear-gradient(45deg,#3498db,#2980b9);border:none;color:white}.btn-warning.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(45deg,#f1c40f,#f39c12);background:-moz-linear-gradient(45deg,#f1c40f,#f39c12);background:-o-linear-gradient(45deg,#f1c40f,#f39c12);background:linear-gradient(45deg,#f1c40f,#f39c12);border:none;color:white}.btn-danger.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(45deg,#e74c3c,#c0392b);background:-moz-linear-gradient(45deg,#e74c3c,#c0392b);background:-o-linear-gradient(45deg,#e74c3c,#c0392b);background:linear-gradient(45deg,#e74c3c,#c0392b);border:none}.income-gradient.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(315deg,#1a5f7a 0%,#2c3e50 100%);background:-moz-linear-gradient(315deg,#1a5f7a 0%,#2c3e50 100%);background:-o-linear-gradient(315deg,#1a5f7a 0%,#2c3e50 100%);background:linear-gradient(135deg,#1a5f7a 0%,#2c3e50 100%)}.table.jsx-7bf74096ad2f8413 thead.jsx-7bf74096ad2f8413 th.jsx-7bf74096ad2f8413{background:-webkit-linear-gradient(45deg,#34495e,#415b76);background:-moz-linear-gradient(45deg,#34495e,#415b76);background:-o-linear-gradient(45deg,#34495e,#415b76);background:linear-gradient(45deg,#34495e,#415b76);color:#fff;font-weight:500;padding:15px;font-size:.95rem;border:none;text-transform:uppercase;letter-spacing:.5px}.table.jsx-7bf74096ad2f8413 tbody.jsx-7bf74096ad2f8413 tr.jsx-7bf74096ad2f8413{-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.table.jsx-7bf74096ad2f8413 tbody.jsx-7bf74096ad2f8413 tr.jsx-7bf74096ad2f8413:hover{background-color:rgba(52,152,219,.05);-webkit-transform:scale(1.005);-moz-transform:scale(1.005);-ms-transform:scale(1.005);-o-transform:scale(1.005);transform:scale(1.005)}.card.jsx-7bf74096ad2f8413{border:none;-webkit-border-radius:.5rem;-moz-border-radius:.5rem;border-radius:.5rem;-webkit-transition:-webkit-transform.2s,box-shadow.2s;-moz-transition:-moz-transform.2s,box-shadow.2s;-o-transition:-o-transform.2s,box-shadow.2s;transition:-webkit-transform.2s,box-shadow.2s;transition:-moz-transform.2s,box-shadow.2s;transition:-o-transform.2s,box-shadow.2s;transition:transform.2s,box-shadow.2s;margin-bottom:25px}.card-header.jsx-7bf74096ad2f8413{border-bottom:2px solid rgba(0,0,0,.1);padding:15px 20px}"})]})}},7630:function(e,t,r){var a;a=function(e,t){"use strict";let r=[{key:"title",getter:e=>e.getTitle()},{key:"html",getter:e=>e.getHtmlContainer()},{key:"confirmButtonText",getter:e=>e.getConfirmButton()},{key:"denyButtonText",getter:e=>e.getDenyButton()},{key:"cancelButtonText",getter:e=>e.getCancelButton()},{key:"footer",getter:e=>e.getFooter()},{key:"closeButtonHtml",getter:e=>e.getCloseButton()},{key:"iconHtml",getter:e=>e.getIconContent()},{key:"loaderHtml",getter:e=>e.getLoader()}],a=()=>{};return function(n){function o(t){let a={},n={},o=r.map(e=>e.key);return Object.entries(t).forEach(t=>{let[r,s]=t;o.includes(r)&&e.isValidElement(s)?(a[r]=s,n[r]=" "):n[r]=s}),[a,n]}function s(e,a){Object.entries(a).forEach(a=>{let[o,s]=a,i=r.find(e=>e.key===o).getter(n),d=t.createRoot(i);d.render(s),e.__roots.push(d)})}function i(e){e.__roots.forEach(e=>{e.unmount()}),e.__roots=[]}return class extends n{static argsToParams(t){if(!(e.isValidElement(t[0])||e.isValidElement(t[1])))return n.argsToParams(t);{let e={};return["title","html","icon"].forEach((r,a)=>{void 0!==t[a]&&(e[r]=t[a])}),e}}_main(e,t){this.__roots=[],this.__params=Object.assign({},t,e);let[r,n]=o(this.__params),d=n.willOpen||a,c=n.didOpen||a,l=n.didDestroy||a;return super._main(Object.assign({},n,{willOpen:e=>{s(this,r),d(e)},didOpen:e=>{setTimeout(()=>{c(e)})},didDestroy:e=>{l(e),i(this)}}))}update(e){Object.assign(this.__params,e),i(this);let[t,r]=o(this.__params);super.update(r),s(this,t)}}}},e.exports=a(r(7294),r(745))}},function(e){e.O(0,[645,1664,676,343,4269,2198,2888,9774,179],function(){return e(e.s=1706)}),_N_E=e.O()}]);