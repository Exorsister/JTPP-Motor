(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8646],{4184:function(e,t){var a;!function(){"use strict";var r={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var n=typeof a;if("string"===n||"number"===n)e.push(a);else if(Array.isArray(a)){if(a.length){var c=s.apply(null,a);c&&e.push(c)}}else if("object"===n){if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]")){e.push(a.toString());continue}for(var l in a)r.call(a,l)&&a[l]&&e.push(l)}}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0!==(a=(function(){return s}).apply(t,[]))&&(e.exports=a)}()},3667:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backend/Product/Add_Product",function(){return a(4079)}])},4079:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var r=a(5893),s=a(7294),n=a(2198),c=a(1163),l=a(343),o=a(4269),i=a(6455),d=a.n(i);function m(){let e=(0,c.useRouter)(),[t,a]=(0,s.useState)([]),[i,m]=(0,s.useState)([]),[u,p]=(0,s.useState)([]),[h,f]=(0,s.useState)({image:"",category:"",Product_Name:"",Product_Brand:"",Product_Brand_ID:"",Product_Model:"",Product_Model_ID:"",Quantity:"",price:"",Unit_Cost:""}),_=(0,l.ZP)(),[b,j]=(0,s.useState)("");(0,s.useEffect)(()=>{x(),N()},[]);let x=async()=>{try{let e=await fetch("https://server.jtppmotor.com/api/category");if(e.ok){let t=await e.json();p(t.map(e=>({value:e.Product_type_ID,label:e.Product_type_name})))}}catch(e){console.error("Error fetching categories:",e),d().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลหมวดหมู่ได้","error")}},N=async()=>{try{let e=await fetch("https://server.jtppmotor.com/api/product/get_product_brands");if(e.ok){let t=await e.json();a(t.data.map(e=>({value:e.product_brands_ID,label:e.product_brands_Name})))}}catch(e){console.error("Error fetching brands:",e),d().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลแบรนด์ได้","error")}},v=async e=>{try{let t=await fetch("https://server.jtppmotor.com/api/product/get_product_model/".concat(e));if(t.ok){let e=await t.json();m(e.map(e=>({value:e.product_models_ID,label:e.product_models_Name})))}}catch(e){console.error("Error fetching models:",e),d().fire("เกิดข้อผิดพลาด","ไม่สามารถดึงข้อมูลรุ่นได้","error")}},y=e=>{let{name:t,value:a}=e.target;"image"===t?f({...h,[t]:e.target.files[0]}):f({...h,[t]:a})},g=async t=>{if(t.preventDefault(),!h.image){j("กรุณาเลือกรูปภาพ");return}if(!h.category){j("กรุณาเลือกหมวดหมู่");return}if(!h.Product_Brand_ID){j("กรุณาเลือกยี่ห้อสินค้า");return}if(!h.Product_Model_ID){j("กรุณาเลือกรุ่นสินค้า");return}if(!h.Product_Name){j("กรุณากรอกชื่อสินค้า");return}if(!h.Quantity||h.Quantity<=0){j("กรุณากรอกจำนวนสินค้าให้ถูกต้อง");return}if(!h.price||h.price<=0){j("กรุณากรอกราคาสินค้าให้ถูกต้อง");return}if(!h.Unit_Cost||h.Unit_Cost<=0){j("กรุณากรอกราคาต้นทุนให้ถูกต้อง");return}let a=new FormData;a.append("image",h.image),a.append("category",h.category),a.append("Product_Brand",h.Product_Brand),a.append("Product_Model",h.Product_Model),a.append("Product_Brand_ID",h.Product_Brand_ID),a.append("Product_Model_ID",h.Product_Model_ID),a.append("Product_Name",h.Product_Name),a.append("Quantity",h.Quantity),a.append("price",h.price),a.append("Unit_Cost",h.Unit_Cost);try{let t=await fetch("https://server.jtppmotor.com/api/add_products",{method:"POST",body:a});if(t.ok)d().fire({icon:"success",title:"สำเร็จ",text:"สร้างสินค้าเรียบร้อยแล้ว"}).then(()=>{e.push("/backend/Product/Product_list")});else{let e=await t.json();j(e.error||"เกิดข้อผิดพลาดในการสร้างสินค้า")}}catch(e){j("เกิดข้อผิดพลาดในการเชื่อมต่อกับเซิร์ฟเวอร์")}};return(0,r.jsxs)("div",{className:"d-flex",children:[(0,r.jsx)(n.default,{}),(0,r.jsx)("div",{className:"flex-grow-1",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("div",{className:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom",children:(0,r.jsx)("div",{className:"d-flex justify-content-end w-98",children:(0,r.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-secondary",onClick:()=>e.back(),children:"ย้อนกลับ"})})}),(0,r.jsx)("div",{className:"d-flex flex-wrap align-items-center justify-content-center justify-content-md-between",children:(0,r.jsxs)("a",{className:"d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none",children:[(0,r.jsx)("i",{className:"bi bi-cart me-2"}),"เพิ่มสินค้า"]})}),(0,r.jsx)("div",{className:"my-4"}),b&&(0,r.jsx)("div",{className:"alert alert-danger",role:"alert",children:b}),(0,r.jsx)("div",{className:"card shadow-sm",children:(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("form",{onSubmit:g,encType:"multipart/form-data",children:[(0,r.jsxs)("div",{className:"row g-3",children:[(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"image",className:"form-label",children:"รูปภาพ"}),(0,r.jsx)("input",{type:"file",className:"form-control",id:"image",name:"image",accept:"image/*",onChange:y})]})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"category",className:"form-label",children:"หมวดหมู่"}),(0,r.jsx)(o.ZP,{components:_,options:u,onChange:e=>y({target:{name:"category",value:e.value}}),placeholder:"เลือกหมวดหมู่"})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"Product_Brand",className:"form-label",children:"ยี่ห้อสินค้า"}),(0,r.jsx)(o.ZP,{components:_,options:t,onChange:e=>{f(t=>({...t,Product_Brand_ID:e.value,Product_Brand:e.label})),v(e.value)},placeholder:"เลือกยี่ห้อสินค้า"})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"Product_Model",className:"form-label",children:"รุ่นสินค้า"}),(0,r.jsx)(o.ZP,{components:_,options:i,onChange:e=>{f(t=>({...t,Product_Model_ID:e.value,Product_Model:e.label}))},placeholder:"เลือกรุ่นสินค้า"})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"Product_Name",className:"form-label",children:"ชื่อสินค้า"}),(0,r.jsx)("input",{type:"text",className:"form-control",id:"Product_Name",name:"Product_Name",value:h.Product_Name,onChange:y})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"Quantity",className:"form-label",children:"จำนวนชิ้น"}),(0,r.jsx)("input",{type:"number",className:"form-control",id:"Quantity",name:"Quantity",value:h.Quantity,onChange:y})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"price",className:"form-label",children:"ราคาต่อชิ้น"}),(0,r.jsx)("input",{type:"number",className:"form-control",id:"price",name:"price",value:h.price,onChange:y})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"Unit_Cost",className:"form-label",children:"ราคาต้นทุน"}),(0,r.jsx)("input",{type:"number",className:"form-control",id:"Unit_Cost",name:"Unit_Cost",value:h.Unit_Cost,onChange:y})]})})]}),(0,r.jsx)("div",{className:"d-grid gap-2 d-md-flex justify-content-md-end",children:(0,r.jsxs)("button",{className:"btn btn-primary",type:"submit",children:[(0,r.jsx)("i",{className:"bi bi-plus-circle me-2"}),"เพิ่มสินค้า"]})})]})})})]})})]})}}},function(e){e.O(0,[676,343,4269,2198,2888,9774,179],function(){return e(e.s=3667)}),_N_E=e.O()}]);