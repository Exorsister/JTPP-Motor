(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9977],{4184:function(e,a){var t;!function(){"use strict";var s={}.hasOwnProperty;function i(){for(var e=[],a=0;a<arguments.length;a++){var t=arguments[a];if(t){var r=typeof t;if("string"===r||"number"===r)e.push(t);else if(Array.isArray(t)){if(t.length){var l=i.apply(null,t);l&&e.push(l)}}else if("object"===r){if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]")){e.push(t.toString());continue}for(var n in t)s.call(t,n)&&t[n]&&e.push(n)}}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0!==(t=(function(){return i}).apply(a,[]))&&(e.exports=t)}()},7283:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/backend/Admin/[User_ID]",function(){return t(1057)}])},1057:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return p}});var s=t(5893),i=t(7294),r=t(1163),l=t(2198),n=t(6455),o=t.n(n),c=t(1982),d=t(4269),m=t(343);function p(){let e=(0,r.useRouter)(),{User_ID:a}=e.query,[t,n]=(0,i.useState)({firstName:"",lastname:"",email:"",phone:"",password:"",profile_img:null,birth_date:"",live:"",subdistrict:"",district:"",province:"",zip_code:""}),[p,u]=(0,i.useState)(null),[h,f]=(0,i.useState)([]),[b,v]=(0,i.useState)([]),[j,x]=(0,i.useState)([]);(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("https://server.jtppmotor.com/api/provinces"),a=await e.json();f(a);let t=await fetch("https://server.jtppmotor.com/api/districts"),s=await t.json();v(s);let i=await fetch("https://server.jtppmotor.com/api/subdistricts"),r=await i.json();x(r)}catch(e){console.error("Error fetching address data:",e)}})()},[]),(0,i.useEffect)(()=>{if(!localStorage.getItem("token")){e.push("/login");return}let t=async()=>{try{let e=await fetch("https://server.jtppmotor.com/api/get_admins/".concat(a)),t=await e.json(),s="";t.birth_date&&(s=new Date(t.birth_date).toISOString().split("T")[0]),n({firstName:t.User_firstName||"",lastname:t.User_lastName||"",email:t.User_Email||"",phone:t.User_Tel||"",password:"",profile_img:t.profile_img||null,birth_date:s,live:t.live||"",subdistrict:t.subdistrict||"",district:t.district||"",province:t.province||"",zip_code:t.zip_code||""})}catch(e){console.error("Error fetching user data:",e)}};a&&t()},[a]);let N=h.map(e=>({value:e.id,label:e.name_in_thai})),_=b.filter(e=>e.province_id===Number(t.province)).map(e=>({value:e.id,label:e.name_in_thai})),g=j.filter(e=>e.district_id===Number(t.district)).map(e=>({value:e.id,label:e.name_in_thai,zip_code:e.zip_code})),w=e=>{let{name:a,value:t}=e.target;n(e=>({...e,[a]:t}))},y=async s=>{s.preventDefault();let i=localStorage.getItem("token"),r=(0,c.Z)({firstname:t.firstName,lastname:t.lastname,email:t.email,password:t.password,tel:t.phone});if(Object.keys(r).length>0){let e=Object.values(r).join("\n");await o().fire({title:"ข้อผิดพลาด",text:e,icon:"error"});return}try{let s=new FormData;if(s.append("firstname",t.firstName),s.append("lastname",t.lastname),s.append("email",t.email),s.append("tel",t.phone),s.append("birth_date",t.birth_date),s.append("live",t.live),s.append("subdistrict",t.subdistrict),s.append("district",t.district),s.append("province",t.province),s.append("zip_code",t.zip_code),t.password&&s.append("password",t.password),t.profile_img instanceof File&&s.append("profile_img",t.profile_img),!(await fetch("https://server.jtppmotor.com/api/edit_admins/".concat(a),{method:"PUT",headers:{Authorization:"Bearer ".concat(i)},body:s})).ok)throw Error("ไม่สามารถอัปเดตข้อมูลได้");await o().fire({title:"สำเร็จ",text:"อัปเดตข้อมูลเรียบร้อยแล้ว",icon:"success"}),e.push("/backend/Admin/Administrator")}catch(e){console.error("Error:",e),await o().fire({title:"เกิดข้อผิดพลาด",text:e.message,icon:"error"})}};return(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(l.default,{}),(0,s.jsx)("div",{className:"flex-grow-1",children:(0,s.jsxs)("div",{className:"container py-5",children:[(0,s.jsx)("div",{className:"d-flex justify-content-end mb-4",children:(0,s.jsxs)("button",{className:"btn btn-outline-secondary btn-modern d-flex align-items-center gap-2",onClick:()=>e.push("/backend/Admin/Administrator"),children:[(0,s.jsx)("i",{className:"bi bi-arrow-left"}),"ย้อนกลับ"]})}),(0,s.jsx)("div",{className:"row justify-content-center",children:(0,s.jsx)("div",{className:"col-md-8",children:(0,s.jsx)("div",{className:"card shadow",children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h2",{className:"card-title text-center mb-4",children:"แก้ไขข้อมูลผู้ดูแลระบบ"}),(0,s.jsxs)("form",{onSubmit:y,children:[(0,s.jsxs)("div",{className:"text-center mb-4",children:[(0,s.jsx)("div",{style:{width:"200px",height:"200px",margin:"0 auto",position:"relative",border:"3px solid #ddd",borderRadius:"50%",overflow:"hidden"},children:p||t.profile_img?(0,s.jsx)("img",{src:p||"https://server.jtppmotor.com/uploads/".concat(t.profile_img),alt:"Profile",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,s.jsx)("i",{className:"bi bi-person-fill",style:{width:"100%",height:"100%",fontSize:"100px",display:"flex",alignItems:"center",justifyContent:"center"}})}),(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("label",{htmlFor:"profile_img",className:"btn btn-outline-primary",children:"เลือกรูปภาพ"}),(0,s.jsx)("input",{type:"file",id:"profile_img",accept:"image/*",onChange:e=>{let a=e.target.files[0];a&&(n(e=>({...e,profile_img:a})),u(URL.createObjectURL(a)))},className:"d-none"})]})]}),(0,s.jsxs)("div",{className:"row mb-3",children:[(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label",children:"ชื่อ"}),(0,s.jsx)("input",{type:"text",className:"form-control",name:"firstName",value:t.firstName,onChange:w,required:!0})]}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label",children:"นามสกุล"}),(0,s.jsx)("input",{type:"text",className:"form-control",name:"lastname",value:t.lastname,onChange:w,required:!0})]})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"อีเมล"}),(0,s.jsx)("input",{type:"email",className:"form-control",name:"email",value:t.email,onChange:w,required:!0})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"เบอร์โทรศัพท์"}),(0,s.jsx)("input",{type:"tel",className:"form-control",name:"phone",value:t.phone,onChange:w,required:!0})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"รหัสผ่าน"}),(0,s.jsx)("input",{type:"password",className:"form-control",name:"password",value:t.password,onChange:w,placeholder:"ใส่รหัสผ่านเพื่อเปลี่ยนแปลงข้อมูล"})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"วันเกิด"}),(0,s.jsx)("input",{type:"date",className:"form-control",name:"birth_date",value:t.birth_date,onChange:w})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{className:"form-label",children:"ที่อยู่"}),(0,s.jsx)("textarea",{className:"form-control",name:"live",value:t.live,onChange:w,rows:"3"})]}),(0,s.jsxs)("div",{className:"row mb-3",children:[(0,s.jsxs)("div",{className:"col-md-4",children:[(0,s.jsx)("label",{className:"form-label",children:"จังหวัด"}),(0,s.jsx)(d.ZP,{components:(0,m.ZP)(),options:N,value:N.find(e=>Number(e.value)===Number(t.province))||null,onChange:e=>{n(a=>({...a,province:e?e.value:"",district:"",subdistrict:"",zip_code:""}))},placeholder:"เลือกจังหวัด"})]}),(0,s.jsxs)("div",{className:"col-md-4",children:[(0,s.jsx)("label",{className:"form-label",children:"อำเภอ"}),(0,s.jsx)(d.ZP,{components:(0,m.ZP)(),options:_,value:_.find(e=>Number(e.value)===Number(t.district))||null,onChange:e=>{n(a=>({...a,district:e?e.value:"",subdistrict:"",zip_code:""}))},placeholder:"เลือกอำเภอ",isDisabled:!t.province})]}),(0,s.jsxs)("div",{className:"col-md-4",children:[(0,s.jsx)("label",{className:"form-label",children:"ตำบล"}),(0,s.jsx)(d.ZP,{components:(0,m.ZP)(),options:g,value:g.find(e=>Number(e.value)===Number(t.subdistrict))||null,onChange:e=>{let a=j.find(a=>a.id===e.value);n(t=>({...t,subdistrict:e?e.value:"",zip_code:a?a.zip_code:""}))},placeholder:"เลือกตำบล",isDisabled:!t.district})]})]}),(0,s.jsx)("div",{className:"row mb-3",children:(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("label",{className:"form-label",children:"รหัสไปรษณีย์"}),(0,s.jsx)("input",{type:"text",className:"form-control",name:"zip_code",value:t.zip_code,onChange:w})]})}),(0,s.jsx)("div",{className:"d-grid gap-2",children:(0,s.jsx)("button",{type:"submit",className:"btn btn-primary",children:"บันทึกการเปลี่ยนแปลง"})})]})]})})})})]})})]})}},1982:function(e,a,t){"use strict";function s(e){let a={},t=/^[a-zA-Zก-ฮะ-์]+$/;return""===e.firstname?a.firstname="ชื่อไม่ควรที่จะเป็นช่องว่าง":t.test(e.firstname)||(a.firstname="ชื่อไม่ควรมีตัวเลขหรืออักษรพิเศษ"),""===e.lastname?a.lastname="นามสกุลไม่ควรที่จะเป็นช่องว่าง":t.test(e.lastname)||(a.lastname="นามสกุลไม่ควรมีตัวเลขหรืออักษรพิเศษ"),""===e.email?a.email="อีเมลไม่ควรที่จะเป็นช่องว่าง":/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.email)||(a.email="อีเมลไม่ถูกต้อง"),""===e.password?a.password="รหัสไม่ควรที่จะเป็นช่องว่าง":/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,20}/.test(e.password)||(a.password="รหัสผ่านไม่ถูกต้อง"),""===e.tel?a.tel="เบอร์โทรศัพท์ไม่ควรที่จะเป็นช่องว่าง":/^\d{10}$/.test(e.tel)||(a.tel="เบอร์โทรศัพท์ไม่ถูกต้อง"),a}t.d(a,{Z:function(){return s}})}},function(e){e.O(0,[676,343,4269,2198,2888,9774,179],function(){return e(e.s=7283)}),_N_E=e.O()}]);