(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9687],{463:function(t,e,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/frontend/Product/Product_detail/[Product_ID]",function(){return r(4233)}])},1365:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return n}});var s=r(5893);function n(){return(0,s.jsx)("footer",{style:{width:"100%",backgroundColor:"#382424",marginTop:"auto"},children:(0,s.jsx)("div",{className:"container",children:(0,s.jsxs)("div",{className:"py-4 px-4",children:[(0,s.jsxs)("div",{className:"row text-center text-md-start",children:[(0,s.jsxs)("div",{className:"col-12 col-md-4 mb-3 d-flex flex-column align-items-center align-items-md-start",children:[(0,s.jsx)("h5",{className:"text-white",children:"JTPP MOTOR"}),(0,s.jsx)("p",{className:"text-white",style:{fontSize:"1rem",lineHeight:"1.6"},children:"จำหน่ายอะไหล่มอเตอร์ไซค์คุณภาพดี ราคาเป็นมิตร พร้อมบริการที่ประทับใจ"})]}),(0,s.jsxs)("div",{className:"col-12 col-md-4 mb-3 d-flex flex-column align-items-center align-items-md-start",children:[(0,s.jsx)("h5",{className:"text-white",children:"ติดต่อเรา"}),(0,s.jsxs)("ul",{className:"list-unstyled",children:[(0,s.jsxs)("li",{className:"text-white",style:{fontSize:"1rem"},children:[(0,s.jsx)("i",{className:"bi bi-geo-alt me-2"})," 199/2, ตำบลดงเย็น, อำเภอบ้านดุง, อุดรธานี 41190"]}),(0,s.jsxs)("li",{className:"text-white",style:{fontSize:"1rem"},children:[(0,s.jsx)("i",{className:"bi bi-telephone me-2"})," 095-606-4364"]})]})]}),(0,s.jsxs)("div",{className:"col-12 col-md-4 mb-3 d-flex flex-column align-items-center align-items-md-end",children:[(0,s.jsx)("h5",{className:"text-white",children:"ติดตามเรา"}),(0,s.jsxs)("div",{className:"d-flex gap-3 justify-content-center",children:[(0,s.jsx)("a",{href:"#",className:"text-white fs-3",children:(0,s.jsx)("i",{className:"bi bi-facebook"})}),(0,s.jsx)("a",{href:"#",className:"text-white fs-3",children:(0,s.jsx)("i",{className:"bi bi-line"})}),(0,s.jsx)("a",{href:"#",className:"text-white fs-3",children:(0,s.jsx)("i",{className:"bi bi-instagram"})})]})]})]}),(0,s.jsx)("div",{className:"border-top pt-3 mt-3 text-center",children:(0,s.jsx)("p",{className:"mb-0 text-white",style:{fontSize:"0.9rem"},children:"\xa9 2023 JTPP MOTOR. All rights reserved."})})]})})})}},4233:function(t,e,r){"use strict";r.r(e);var s=r(5893),n=r(7294),a=r(1163),i=r(763),c=r(1365),o=r(6455),l=r.n(o),d=r(6245);e.default=()=>{let t=(0,a.useRouter)(),{Product_ID:e,previousPage:r}=t.query,[o,m]=(0,n.useState)(null),[u,x]=(0,n.useState)(!0),[h,p]=(0,n.useState)(null),[f,j]=(0,n.useState)(1),[N,g]=(0,n.useState)(!1);(0,n.useEffect)(()=>{t.isReady&&e&&y()},[t.isReady,e]);let y=async()=>{x(!0),p(null);try{let t=await fetch("https://server.jtppmotor.com/api/product_detail/".concat(e));if(!t.ok)throw Error("ไม่สามารถโหลดข้อมูลสินค้าได้");let r=await t.json(),s={...r[0],Price_product:Math.max(...r.map(t=>t.Price_product||0)),Stock_Quantity:r.reduce((t,e)=>"มีสินค้า"!==e.Stock_Status||e.deleted_at?t:t+Number(e.Stock_Quantity||0),0)};m(s)}catch(t){console.error("Error:",t),p("เกิดข้อผิดพลาดในการโหลดข้อมูล")}finally{x(!1)}},b=async()=>{try{let e=localStorage.getItem("token");if(!e){await l().fire({title:"คุณยังไม่เข้าสู่ระบบ",text:"กรุณาเข้าสู่ระบบก่อนทำการจองสินค้า",icon:"warning",confirmButtonText:"เข้าสู่ระบบ",confirmButtonColor:"#3085d6"}),t.push("/components/Login");return}if(!f||f<1){await l().fire({title:"ไม่สามารถทำรายการได้",text:"กรุณาระบุจำนวนสินค้าที่ต้องการจอง",icon:"warning",confirmButtonText:"ตกลง",confirmButtonColor:"#3085d6"});return}if(f>o.Stock_Quantity){await l().fire({title:"ไม่สามารถทำรายการได้",text:"จำนวนสินค้าที่ต้องการจองมีมากกว่าจำนวนที่มีในสต็อก",icon:"warning",confirmButtonText:"ตกลง",confirmButtonColor:"#3085d6"});return}let r=o.Price_product*f;try{let t=await fetch("https://server.jtppmotor.com/api/authen",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok)throw Error("Token ไม่ถูกต้องหรือหมดอายุ");let{decoded:s}=await t.json(),n={userName:"".concat(s.firstName," ").concat(s.lastname),userTel:s.phone};if(!(await l().fire({title:"ยืนยันการจอง",html:'\n            <div class="text-center mb-3">\n              <img src="https://server.jtppmotor.com/uploads/'.concat(o.Product_pic,'" \n                  alt="').concat(o.Product_Name,'" \n                  style="max-width: 200px; height: auto; border-radius: 8px; margin-bottom: 15px;">\n              <div style="border: 1px solid #dee2e6; border-radius: 8px; padding: 15px; margin-top: 15px;">\n                <p style="font-size: 18px; font-weight: bold; color: #333;">').concat(o.Product_Name,'</p>\n                <p style="color: #666;">จำนวน: ').concat(f,' ชิ้น</p>\n                <p style="color: #dc3545; font-weight: bold;">ราคารวม: ').concat(r.toLocaleString(),' บาท</p>\n                <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #dee2e6;">\n                  <p style="color: #666;">ชื่อผู้จอง: ').concat(n.userName,'</p>\n                  <p style="color: #666;">เบอร์โทร: ').concat(n.userTel,"</p>\n                </div>\n              </div>\n            </div>\n          "),icon:"question",showCancelButton:!0,confirmButtonText:"ยืนยันการจอง",cancelButtonText:"ยกเลิก",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",width:"600px"})).isConfirmed)return;g(!0);let a={userName:n.userName,userTel:n.userTel,orderTotalPrice:r,orderNote:"",orderDetails:[{productId:o.Product_ID,price:o.Price_product,priceAll:r,amount:f}],userId:s.User_ID},i=await fetch("https://server.jtppmotor.com/api/order/addOrderSell",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(a)});if(!i.ok)throw Error("ไม่สามารถทำการจองได้");let c=await i.json();await l().fire({title:"การจองสำเร็จ!",html:'\n            <div>\n              <p>คุณได้ทำการจองสินค้า "'.concat(o.Product_Name,'" จำนวน ').concat(f," ชิ้น</p>\n              <p>ราคารวม: ").concat(r.toLocaleString()," บาท</p>\n              <p>หมายเลขการจอง: ").concat(c.orderId,"</p>\n            </div>\n          "),imageUrl:"https://server.jtppmotor.com/uploads/".concat(o.Product_pic),imageWidth:400,imageHeight:200,imageAlt:"รูปภาพสินค้า",confirmButtonText:"ตกลง",confirmButtonColor:"#3085d6"}),await y()}catch(e){console.error("Error validating token:",e),localStorage.removeItem("token"),await l().fire({title:"กรุณาเข้าสู่ระบบใหม่",text:"Session หมดอายุ กรุณาเข้าสู่ระบบอีกครั้ง",icon:"error",confirmButtonText:"ตกลง"}),t.push("/components/Login");return}}catch(t){console.error("Error:",t),await l().fire({title:"เกิดข้อผิดพลาด",text:t.message||"ไม่สามารถทำการจองสินค้าได้ กรุณาลองใหม่อีกครั้ง",icon:"error",confirmButtonText:"ตกลง"})}finally{g(!1)}};return u?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsxs)("div",{className:"container text-center py-5",children:[(0,s.jsx)("div",{className:"spinner-border",role:"status",children:(0,s.jsx)("span",{className:"visually-hidden",children:"กำลังโหลด..."})}),(0,s.jsx)("p",{children:"กำลังโหลดข้อมูลสินค้า..."})]}),(0,s.jsx)(c.default,{})]}):h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsxs)("div",{className:"container text-center py-5",children:[(0,s.jsx)("div",{className:"alert alert-danger",children:h}),(0,s.jsx)("button",{className:"btn btn-primary mt-3",onClick:()=>t.push("/frontend/Product"),children:"กลับสู่หน้าสินค้า"})]}),(0,s.jsx)(c.default,{})]}):o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsx)("div",{className:"container py-4",children:(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-md-6",children:(0,s.jsx)("img",{src:"https://server.jtppmotor.com/uploads/".concat(o.Product_pic),alt:o.Product_Name,className:"img-fluid rounded shadow",style:{width:"100%",height:"400px",objectFit:"contain"}})}),(0,s.jsxs)("div",{className:"col-md-6",children:[(0,s.jsx)("h1",{className:"mb-3",children:o.Product_Name}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("span",{className:"badge bg-primary me-2",children:o.Product_type_name}),(0,s.jsxs)("span",{className:"text-muted",children:[o.Product_Brand," ",o.Product_Model]})]}),(0,s.jsx)("div",{className:"card mb-4 shadow-sm",style:{borderRadius:"10px",border:"none"},children:(0,s.jsxs)("div",{className:"card-body",children:[(0,s.jsx)("h5",{className:"card-title mb-4",style:{color:"#2c3e50",borderBottom:"2px solid #3498db",paddingBottom:"10px",fontSize:"1.2rem",fontWeight:"600"},children:"ข้อมูลจำเพาะของสินค้า"}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{className:"col-12 mb-2",children:(0,s.jsxs)("p",{className:"mb-2",style:{fontSize:"1rem"},children:[(0,s.jsx)("strong",{style:{color:"#34495e",marginRight:"8px"},children:"หมวดหมู่:"}),o.Product_type_name]})}),(0,s.jsx)("div",{className:"col-12 mb-2",children:(0,s.jsxs)("p",{className:"mb-2",style:{fontSize:"1rem"},children:[(0,s.jsx)("strong",{style:{color:"#34495e",marginRight:"8px"},children:"แบรนด์:"}),o.Product_Brand]})}),(0,s.jsx)("div",{className:"col-12 mb-2",children:(0,s.jsxs)("p",{className:"mb-2",style:{fontSize:"1rem"},children:[(0,s.jsx)("strong",{style:{color:"#34495e",marginRight:"8px"},children:"รุ่น:"}),o.Product_Model]})})]})]})}),(0,s.jsx)("p",{className:"text-muted mb-3",children:o.Product_Detail}),(0,s.jsx)("div",{className:"mb-3",children:(0,s.jsxs)("h3",{className:"text-danger",children:["ราคา: ",o.Price_product.toLocaleString()," บาท"]})}),(0,s.jsxs)("div",{className:"alert alert-info",children:[(0,s.jsx)("strong",{children:"สถานะสินค้า:"}),(0,s.jsxs)("span",{className:"ms-2 ".concat(o.Stock_Quantity>10?"text-success":"text-warning"),children:["มีสินค้าในสต็อก ",o.Stock_Quantity," ชิ้น"]})]}),(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("label",{htmlFor:"reservationAmount",className:"form-label",children:"จำนวนที่ต้องการจอง:"}),(0,s.jsx)("input",{type:"number",className:"form-control",id:"reservationAmount",min:"1",max:o.Stock_Quantity,value:f,onChange:t=>j(parseInt(t.target.value)||0)})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsx)("button",{className:"btn btn-primary me-2",onClick:b,disabled:N||o.Stock_Quantity<=0||!f,children:N?"กำลังดำเนินการ...":"จองสินค้า"}),(0,s.jsx)("button",{className:"btn btn-outline-primary me-2",onClick:async()=>{let e=localStorage.getItem("token");if(!e){await l().fire({title:"กรุณาเข้าสู่ระบบ",text:"ต้องเข้าสู่ระบบก่อนเพิ่มสินค้าลงตะกร้า",icon:"warning",confirmButtonText:"เข้าสู่ระบบ"}),t.push("/components/Login");return}if(o.Stock_Quantity<=0){await l().fire({title:"ไม่สามารถเพิ่มสินค้าได้",text:"สินค้าหมดสต็อก",icon:"warning"});return}let r=(0,d.Z)(e),s="cart_".concat(r.User_ID),n=JSON.parse(localStorage.getItem(s)||"[]"),a=n.find(t=>t.Product_ID===o.Product_ID);if(a){let t=a.quantity+f;if(t>o.Stock_Quantity){await l().fire({title:"ไม่สามารถเพิ่มสินค้าได้",text:"จำนวนรวมในตะกร้า (".concat(a.quantity," + ").concat(f,") เกินจำนวนในสต็อก (").concat(o.Stock_Quantity,")"),icon:"warning"});return}a.quantity=t}else n.push({...o,quantity:f});localStorage.setItem(s,JSON.stringify(n)),await l().fire({title:"เพิ่มลงตะกร้าแล้ว",icon:"success"})},disabled:o.Stock_Quantity<=0||!f,children:o.Stock_Quantity<=0?"สินค้าหมด":"เพิ่มลงตะกร้า"}),(0,s.jsx)("button",{className:"btn btn-outline-secondary",onClick:()=>{r?t.push(decodeURIComponent(r)):t.push("/frontend/Product/Product_list")},children:"กลับสู่หน้าสินค้า"})]})]})]})}),(0,s.jsx)(c.default,{})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.default,{}),(0,s.jsxs)("div",{className:"container text-center py-5",children:[(0,s.jsx)("div",{className:"alert alert-warning",children:"ไม่พบข้อมูลสินค้า"}),(0,s.jsx)("button",{className:"btn btn-primary mt-3",onClick:()=>t.push("/frontend/Product"),children:"กลับสู่หน้าสินค้า"})]}),(0,s.jsx)(c.default,{})]})}}},function(t){t.O(0,[1664,763,2888,9774,179],function(){return t(t.s=463)}),_N_E=t.O()}]);