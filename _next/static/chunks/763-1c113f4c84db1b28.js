"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[763],{763:function(e,r,s){s.r(r),s.d(r,{default:function(){return d}});var t=s(5893),i=s(1664),n=s.n(i),o=s(1163),a=s(7294),l=s(6245);function d(){let e=(0,o.useRouter)(),[r,s]=(0,a.useState)(!1),[i,d]=(0,a.useState)(null),[c,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{let r=()=>{"undefined"!=typeof document&&[...document.querySelectorAll(".dropdown-toggle")].forEach(e=>{window.bootstrap&&new window.bootstrap.Dropdown(e)})};return(async()=>{let e=localStorage.getItem("token");if(e)try{let t=(0,l.Z)(e),i=Math.floor(Date.now()/1e3);if(t.exp<i){p();return}s(!0);let n="User"===t.role?"https://server.jtppmotor.com/api/get_customers/".concat(t.User_ID):"https://server.jtppmotor.com/api/get_admins/".concat(t.User_ID),o=await fetch(n),a=await o.json();d({...t,profile_img:a.profile_img}),setTimeout(r,100)}catch(e){console.error("Error fetching user info:",e),p()}else s(!1),d(null)})(),e.events.on("routeChangeComplete",r),()=>{e.events.off("routeChangeComplete",r)}},[e.asPath]),(0,a.useEffect)(()=>{let e=document.createElement("script");return e.src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js",e.async=!0,document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]),(0,a.useEffect)(()=>{let e=()=>{(async()=>{let e=localStorage.getItem("token");if(e){let r=(0,l.Z)(e),s="User"===r.role?"https://server.jtppmotor.com/api/get_customers/".concat(r.User_ID):"https://server.jtppmotor.com/api/get_admins/".concat(r.User_ID),t=await fetch(s),i=await t.json();d({...r,profile_img:i.profile_img})}})()};return window.addEventListener("userUpdated",e),()=>window.removeEventListener("userUpdated",e)},[]);let p=()=>{localStorage.removeItem("token"),s(!1),d(null),e.push("/")};return(0,t.jsx)("div",{className:"container",children:(0,t.jsxs)("header",{className:"d-flex align-items-center justify-content-between py-3 mb-4 border-bottom",children:[(0,t.jsx)("button",{className:"navbar-toggler d-md-none",onClick:()=>m(!c),style:{border:"none",background:"none",padding:"8.84px"},children:(0,t.jsx)("i",{className:"bi bi-list",style:{fontSize:"26.52px"}})}),(0,t.jsx)(n(),{href:"/",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"fs-4 text-decoration-none",style:{fontSize:"1.1rem"},children:"JTPP Motor"})}),(0,t.jsxs)("ul",{className:"nav ".concat(c?"mobile-menu-open":"mobile-menu-closed"," d-md-flex"),children:[(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"nav-link",style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"หน้าหลัก"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/frontend/Checkrepair/Checkrepair",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"nav-link",style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"ตรวจสอบสถานะรถ"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/frontend/Service/Service",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"nav-link",style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"บริการต่างๆ"})})}),(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/frontend/Product/Product_list",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"nav-link",style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"สินค้า"})})}),r&&i&&("Admin"===i.role||"SuperAdmin"===i.role)&&(0,t.jsx)("li",{className:"nav-item",children:(0,t.jsx)(n(),{href:"/backend/Main",legacyBehavior:!0,children:(0,t.jsx)("a",{className:"nav-link",style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"ระบบหลังบ้าน"})})})]}),(0,t.jsx)("div",{className:"d-flex align-items-center gap-2",children:r?(0,t.jsxs)("div",{className:"dropdown d-flex align-items-center",children:[(0,t.jsxs)("button",{className:"btn dropdown-toggle px-3 py-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"8px",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"10px",fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:[(0,t.jsx)("div",{style:{width:"32.3px",height:"32.3px",borderRadius:"50%",border:"2px solid #fff",boxShadow:"0 2px 4px rgba(0,0,0,0.1)",overflow:"hidden"},children:(null==i?void 0:i.profile_img)?(0,t.jsx)("img",{src:"https://server.jtppmotor.com/uploads/".concat(i.profile_img),alt:"Profile",style:{width:"100%",height:"100%",objectFit:"cover"}}):(0,t.jsx)("i",{className:"bi bi-person-fill",style:{width:"100%",height:"100%",fontSize:"20.4px",display:"flex",alignItems:"center",justifyContent:"center"}})}),(0,t.jsx)("span",{style:{color:"#495057",fontWeight:"500"},children:(null==i?void 0:i.firstName)||"User"})]}),(0,t.jsxs)("ul",{className:"dropdown-menu dropdown-menu-end",style:{borderRadius:"8px",boxShadow:"0 4px 6px rgba(0,0,0,0.1)",border:"1px solid #dee2e6",padding:"8px 0",minWidth:"220px"},children:[(0,t.jsx)("li",{children:(0,t.jsxs)("div",{className:"dropdown-item text-muted px-4 py-2",children:[(0,t.jsx)("i",{className:"bi bi-envelope me-2"}),null==i?void 0:i.email]})}),(0,t.jsx)("li",{children:(0,t.jsx)("hr",{className:"dropdown-divider mx-2"})}),(0,t.jsx)("li",{children:(0,t.jsx)(n(),{href:"/frontend/Profile/EditProfile",legacyBehavior:!0,children:(0,t.jsxs)("a",{className:"dropdown-item px-4 py-2",children:[(0,t.jsx)("i",{className:"bi bi-person-gear me-2"}),"แก้ไขโปรไฟล์ส่วนตัว"]})})}),(0,t.jsx)("li",{children:(0,t.jsx)(n(),{href:"/frontend/Cart/Cart_list",legacyBehavior:!0,children:(0,t.jsxs)("a",{className:"dropdown-item px-4 py-2",children:[(0,t.jsx)("i",{className:"bi bi-cart me-2"}),"ตะกร้าสินค้า"]})})}),(0,t.jsx)("li",{children:(0,t.jsx)(n(),{href:"/frontend/History/RepairHistory",legacyBehavior:!0,children:(0,t.jsxs)("a",{className:"dropdown-item px-4 py-2",children:[(0,t.jsx)("i",{className:"bi bi-tools me-2"}),"ประวัติการซ่อม"]})})}),(0,t.jsx)("li",{children:(0,t.jsx)(n(),{href:"/frontend/History/OrderHistory",legacyBehavior:!0,children:(0,t.jsxs)("a",{className:"dropdown-item px-4 py-2",children:[(0,t.jsx)("i",{className:"bi bi-bag-check me-2"}),"ประวัติการจอง"]})})}),(0,t.jsx)("li",{children:(0,t.jsx)("hr",{className:"dropdown-divider mx-2"})}),(0,t.jsx)("li",{children:(0,t.jsxs)("button",{onClick:p,className:"dropdown-item px-4 py-2 text-danger",children:[(0,t.jsx)("i",{className:"bi bi-box-arrow-right me-2"}),"ออกจากระบบ"]})})]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{type:"button",className:"btn btn-outline-primary",onClick:()=>{e.push("/components/Login")},style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"เข้าสู่ระบบ"}),(0,t.jsx)("button",{type:"button",className:"btn btn-primary",onClick:()=>{e.push("/components/Register")},style:{fontSize:"1.1rem",padding:"0.55rem 0.85rem"},children:"สมัครสมาชิก"})]})})]})})}}}]);